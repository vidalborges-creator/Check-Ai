<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - CheckAi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #2c3e50; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .login-card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); width: 350px; text-align: center; }
        .logo-area h2 { color: #3498db; margin: 10px 0; font-size: 28px; }
        .login-card p { color: #7f8c8d; font-size: 14px; margin-bottom: 25px; }
        .field { text-align: left; margin-bottom: 15px; }
        label { font-size: 12px; font-weight: bold; color: #34495e; display: block; margin-bottom: 5px; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; background: #f9f9f9; }
        button { width: 100%; padding: 15px; background: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 10px; transition: 0.3s; }
        button:hover { background: #2980b9; }
    </style>
</head>
<body>

<div class="login-card">
    <div class="logo-area">
        <h2 style="display: flex; align-items: center; justify-content: center; gap: 10px;">
            <i class="fas fa-check-circle"></i> CheckAi
        </h2>
    </div>
    <p>Acesse sua conta para continuar</p>
    
    <div class="field">
        <label>E-mail / Usuário</label>
        <input type="email" id="loginEmail" placeholder="seu-email@superglobo.com.br">
    </div>

    <div class="field">
        <label>Senha</label>
        <input type="password" id="loginSenha" placeholder="******">
    </div>

    <button onclick="realizarLogin()">ENTRAR</button>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBkVb8zenJDjsPSFRCiEmcsOHYhKdquT7M",
        authDomain: "check-ai-9303f.firebaseapp.com",
        projectId: "check-ai-9303f",
        storageBucket: "check-ai-9303f.firebasestorage.app",
        messagingSenderId: "732538707024",
        appId: "1:732538707024:web:d467b1246c7dcb16030555"
    };

    const db = getFirestore(initializeApp(firebaseConfig));

    window.realizarLogin = async () => {
        const email = document.getElementById('loginEmail').value;
        const senha = document.getElementById('loginSenha').value;

        if(!email || !senha) return alert("Preencha todos os campos!");

        try {
            const q = query(collection(db, "usuarios"), 
                        where("login", "==", email), 
                        where("senha", "==", senha));
            
            const querySnapshot = await getDocs(q);

            if (!querySnapshot.empty) {
                const userDoc = querySnapshot.docs[0].data();
                localStorage.setItem('usuarioLogado', userDoc.nome);
                localStorage.setItem('perfilUsuario', userDoc.perfil);

                // IMPORTANTE: Envia para o dashboard após logar
                window.location.href = "dashboard.html"; 
            } else {
                alert("Usuário ou senha incorretos!");
            }
        } catch (e) {
            alert("Erro ao conectar com o servidor.");
        }
    };
</script>
</body>
</html>